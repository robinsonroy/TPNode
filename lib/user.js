// Generated by CoffeeScript 1.11.1
(function() {
  var db;

  db = require('./db')("user");

  module.exports = {
    get: function(callback) {
      return callback(null, db.createReadStream().on('data', function(data) {
        return console.log(data.key, '=', data.value);
      }).on('error', function(err) {
        return console.log('Oh my!', err);
      }).on('close', function() {
        return console.log('Stream closed');
      }).on('end', function() {
        return console.log('Stream ended');
      }));
    },
    get: function(username, password, callback) {
      return db.get(username, function(err, value) {
        var _email, _name, _password, ref;
        if (err) {
          return callback(err);
        } else {
          ref = value.split(':'), _password = ref[0], _name = ref[1], _email = ref[2];
          if (password !== _password) {
            console.log("Password not correct");
            return callback("Password not correct");
          }
          return callback(null, {
            name: _name,
            email: _email,
            username: username
          });
        }
      });
    },
    save: function(username, password, name, email, callback) {
      return db.put("" + username, name + ":" + password + ":" + email, function(err) {
        if (err) {
          return callback(err);
        } else {
          console.log('user ' + username + ' add');
          return callback();
        }
      });
    },
    remove: function(username, callback) {
      return callback(username);
    }
  };

}).call(this);
